generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Restaurants {
  id         String   @id @default(uuid())
  name       String
  created_at DateTime @default(now())
}

model Weeks {
  week_id    String   @id
  start_date DateTime @db.Date
  end_date   DateTime @db.Date
  sheet_name String
}

model TopLine {
  id             BigInt   @id @default(autoincrement())
  week_id        String
  date           String
  day_name       String
  mod_name       String?

  total_sales     Decimal? @db.Decimal(10,2) @default(0)
  lunch_sales     Decimal? @db.Decimal(10,2) @default(0)
  dinner_sales    Decimal? @db.Decimal(10,2) @default(0)

  total_forecast  Decimal? @db.Decimal(10,2) @default(0)
  forecast_lunch  Decimal? @db.Decimal(10,2) @default(0)
  forecast_dinner Decimal? @db.Decimal(10,2) @default(0)

  comp_total      Decimal? @db.Decimal(10,2) @default(0)
  void_total      Decimal? @db.Decimal(10,2) @default(0)

  guest_count     Int?     @default(0)
  training_hours  String?

  @@unique([week_id, date], name: "week_id_date")
  @@index([week_id])
}

model Profit {
  id                BigInt   @id @default(autoincrement())
  week_id           String
  date              String

  main_room_sales   Decimal? @db.Decimal(10,2) @default(0)
  patio_sales       Decimal? @db.Decimal(10,2) @default(0)
  third_party_sales Decimal? @db.Decimal(10,2) @default(0)
  third_party_fees  Decimal? @db.Decimal(10,2) @default(0)   // ðŸ‘ˆ ADD THIS
  togo_sales        Decimal? @db.Decimal(10,2) @default(0)
  catering          Decimal? @db.Decimal(10,2) @default(0)
  
  alcohol_sales     Decimal? @db.Decimal(10,2) @default(0)
  na_bev_sales      Decimal? @db.Decimal(10,2) @default(0)

  foh_reg_hours     Decimal? @db.Decimal(10,2) @default(0)
  foh_reg_wages     Decimal? @db.Decimal(10,2) @default(0)
  foh_ot_hours      Decimal? @db.Decimal(10,2) @default(0)
  foh_ot_wages      Decimal? @db.Decimal(10,2) @default(0)

  boh_reg_hours     Decimal? @db.Decimal(10,2) @default(0)
  boh_reg_wages     Decimal? @db.Decimal(10,2) @default(0)
  boh_ot_hours      Decimal? @db.Decimal(10,2) @default(0)
  boh_ot_wages      Decimal? @db.Decimal(10,2) @default(0)

  comments          String? @db.LongText

  @@unique([week_id, date], name: "profit_week_id_date")
  @@index([week_id])
}

model Deposit {
  id         BigInt   @id @default(autoincrement())
  week_id    String
  date       String

  actual     Decimal? @db.Decimal(10,2) @default(0)
  amount_due Decimal? @db.Decimal(10,2) @default(0)

  @@unique([week_id, date], name: "deposit_week_id_date")
  @@index([week_id])
}

model People {
  id                    BigInt   @id @default(autoincrement())
  week_id               String
  date                  String

  total_staff_scheduled Int?     @default(0)
  shoutouts             String?  @db.LongText
  staffing_issues       String?  @db.LongText

  @@unique([week_id, date], name: "people_week_id_date")
  @@index([week_id])
}

model Operations {
  id                BigInt   @id @default(autoincrement())
  week_id           String
  date              String

  was_there_wait    Boolean? @default(false)
  wait_start        String?
  wait_end          String?
  avg_wait_time     String?

  total_guest_count Int? @default(0)
  comments          String? @db.LongText

  @@unique([week_id, date], name: "operations_week_id_date")
  @@index([week_id])
}


model GuestCountPerHour {
  id       BigInt   @id @default(autoincrement())
  week_id  String
  date     String
  hour     String
  count    Int? @default(0)

  @@unique([week_id, date, hour], name: "guestcount_week_date_hour")
  @@index([week_id])
}

model SalesPerHour {
  id       BigInt   @id @default(autoincrement())
  week_id  String
  date     String
  hour     String
  amount   Decimal? @db.Decimal(10,2)

  @@unique([week_id, date, hour], name: "sales_hour_unique")
  @@index([week_id])
}

enum ShiftType {
  AM
  PM
}

model ScheduledStaff {
  id       BigInt   @id @default(autoincrement())
  week_id  String
  date     String

  role     String
  shift    ShiftType
  count    Int? @default(0)

  @@unique([week_id, date, role, shift])
  @@index([week_id])
}

model FoodCostTracking {
  id        BigInt   @id @default(autoincrement())
  week_id   String
  date      String          
  vendor    String          
  amount    Decimal? @db.Decimal(10,2) @default(0)

  @@index([week_id])
  @@unique([week_id, date, vendor], name: "foodcost_week_date_vendor")
}
